kde4_header()

add_subdirectory( src )
add_subdirectory( pics )

include_directories( ${CMAKE_SOURCE_DIR} ${CMAKE_BINARY_DIR} ${CMAKE_SOURCE_DIR}/kyzis/src/newui/ ${CMAKE_SOURCE_DIR}/kyzis/src/ ${CMAKE_SOURCE_DIR}/libyzis/ ${CMAKE_BINARY_DIR}/libyzis/ ${KDE4_INCLUDE_DIR} ${QT_INCLUDES}  )

########### next target ###############

set(kyzis_SRCS main.cpp )
kde4_automoc(${kyzis_SRCS})
kde4_add_executable(kyzis ${kyzis_SRCS})
target_link_libraries(kyzis ${KDE4_KDECORE_LIBS} ktexteditor ${KDE4_KPARTS_LIBS} yzis internkyzis d)
install_targets(/bin kyzis )

########### next target ###############

set(kyzispart_PART_SRCS dummy.cpp )
kde4_automoc(${kyzispart_PART_SRCS})
file(WRITE dummy.cpp "//autogenerated file by cmake\n")
kde4_add_plugin(kyzispart ${kyzispart_PART_SRCS})
kde4_install_libtool_file( ${PLUGIN_INSTALL_DIR} kyzispart )
target_link_libraries(kyzispart ${KDE4_KDECORE_LIBS} ${KDE4_KPARTS_LIBS} ktexteditor yzis internkyzis )
install_targets(${PLUGIN_INSTALL_DIR} kyzispart )

########### install files ###############

install_files( ${SERVICES_INSTALL_DIR} FILES  kyzispart.desktop )
install_files( ${DATA_INSTALL_DIR}/kyzispart FILES  kyzispart.rc )
install_files( ${DATA_INSTALL_DIR}/kyzis FILES  kyzis_shell.rc )
install_files( ${APPLNK_INSTALL_DIR}/Editors FILES  kyzis.desktop )

kde4_footer()



#original Makefile.am contents follow:

## this has all of the subdirectories that make will recurse into.  if
## there are none, comment this out
#SUBDIRS = src pics .
#
## set the include path for X, qt and KDE
#INCLUDES = -I$(top_srcdir) -I$(top_srcdir)/kyzis/src/newui/ -I$(top_srcdir)/kyzis/src/ -I$(top_srcdir)/libyzis/ -I$(top_builddir)/libyzis/ $(all_includes) $(LUA_INCLUDES)
#
## let automoc handle all of the meta source files (moc)
#METASOURCES = AUTO
#
#bin_PROGRAMS = kyzis
#
## the application source, library search path, and link libraries
#kyzis_SOURCES = main.cpp
#kyzis_LDFLAGS = $(KDE_RPATH) $(all_libraries)
#kyzis_LDADD = -lktexteditor $(LIB_KPARTS) $(top_builddir)/libyzis/libyzis.la $(top_builddir)/kyzis/src/libinternkyzis.la
#
## this is where the desktop file will go 
#shelldesktopdir   = $(kde_appsdir)/Editors
#shelldesktop_DATA = kyzis.desktop
#
## this is where the shell's XML-GUI resource file goes
#shellrcdir   = $(kde_datadir)/kyzis
#shellrc_DATA = kyzis_shell.rc
#
#
#kde_module_LTLIBRARIES = libkyzispart.la
#
## the Part's source, library search path, and link libraries
#libkyzispart_la_SOURCES = dummy.cpp
#libkyzispart_la_LDFLAGS = -module $(KDE_PLUGIN) $(all_libraries)
#libkyzispart_la_LIBADD  = $(LIB_KPARTS) $(LIB_KFILE) -lktexteditor $(top_builddir)/libyzis/libyzis.la $(top_builddir)/kyzis/src/libinternkyzis.la
#
## this is where the desktop file will go 
#partdesktopdir   = $(kde_servicesdir)
#partdesktop_DATA = kyzispart.desktop
#
## this is where the part's XML-GUI resource file goes
#partrcdir   = $(kde_datadir)/kyzispart
#partrc_DATA = kyzispart.rc
#
#
##########################################################################
## MISC SECTION
##########################################################################
#re : clean all
#
#dummy.cpp: 
#	echo "#ifdef _AIX" > $@
#	echo "namespace {" >> $@
#	echo "void *not_empty_file;" >> $@
#	echo "}" >> $@
#	echo "#endif" >> $@
#
#
#install-exec-hook:
#	-@for i in `ls $(top_builddir)/translations/*.gmo`; do \
#		if test ! -f $(DESTDIR)/`$(KDECONFIG) --install locale --expandvars`/`basename $$i .gmo`/LC_MESSAGES/yzis.mo ; then \
#			$(mkinstalldirs) $(DESTDIR)/`$(KDECONFIG) --install locale --expandvars`/`basename $$i .gmo`/LC_MESSAGES/ ; \
#			$(LN_S) $(DESTDIR)$(prefix)/share/locale/`basename $$i .gmo`/LC_MESSAGES/yzis.mo $(DESTDIR)/`$(KDECONFIG) --install locale --expandvars`/`basename $$i .gmo`/LC_MESSAGES/ ; \
#		fi ; \
#	done
#
